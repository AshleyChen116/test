```python
%matplotlib inline

import numpy as np
import matplotlib.pyplot as plt
```


```python
# 讀入 Tensorflow。
```


```python
import tensorflow as tf
```

## 1. 讀入 MNSIT 數據集¶


```python
from tensorflow.keras.datasets import mnist
```


```python
(x_train, y_train), (x_test, y_test) = mnist.load_data()
```

## 2.欣賞數據集內容


```python
len(x_train)
```




    60000




```python
len(x_test)
```




    10000




```python
n =6666
```


```python
x_train[n]
```




    array([[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,  58,   6,  65,   0,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,  22,  98, 105, 235, 235, 235, 235,
            235, 235, 235, 245, 236, 246, 235, 235, 141,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,  36,  77, 192, 223, 254, 254, 254, 254, 228, 240,
            254, 254, 254, 254, 254, 254, 254, 254, 251, 139,   0,   0,   0,
              0,   0],
           [  0,   0,   0, 118, 254, 254, 254, 254, 254, 254, 230,  54, 162,
            199, 199, 199, 199, 143, 125, 254, 254, 254, 224,   0,   0,   0,
              0,   0],
           [  0,   0,   0, 177, 233, 254, 254, 254, 234, 220,  50,   0,   0,
              0,   0,   0,   0,   0,  84, 254, 254, 146,  38,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,  98, 254, 254, 254, 103,   0,   0,   0,   0,
              0,   0,   0,   0,   0, 166, 254, 254,  96,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,  98, 254, 254, 237,  50,   0,   0,   0,   0,
              0,   0,   0,   0,   0, 221, 254, 254,  96,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,  98, 254, 254, 220,   0,   0,   0,   0,   0,
              0,   0,   0,   0,  46, 236, 254, 214,   3,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0, 221, 254, 205,  23,   0,   0,   0,   0,   0,
              0,   0,   0,   0, 152, 254, 254, 164,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,  97, 185, 145,   0,   0,   0,   0,   0,   0,
              0,   0,   0,  34, 245, 254, 254,  75,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0, 125, 254, 254, 209,  20,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   1, 138, 254, 254, 192,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   7, 254, 254, 254, 192,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,  75, 254, 254, 254, 125,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0, 145, 254, 254, 254, 111,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0, 145, 254, 254, 254, 192,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,  37, 254, 254, 254, 207,  19,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   3, 162, 254, 254, 254,  75,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,  47, 152, 234, 245, 144,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,  64,   0,   0,   0,   0,   0,   0,
              0,   0],
           [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
              0,   0]], dtype=uint8)




```python
y_train[n]
```




    7




```python
plt.imshow(x_train[n], cmap='Reds')
```




    <matplotlib.image.AxesImage at 0x637ec9550>




![png](output_12_1.png)


## 3.資料整理


```python
np.array([3, 78, 95, 99])/100
```




    array([0.03, 0.78, 0.95, 0.99])




```python
x_train = x_train/255
x_test = x_test/255
```


```python
x_train.shape
```




    (60000, 28, 28)




```python
x_train = x_train.reshape(60000, 784)
x_test= x_test.reshape(10000, 784)
```


```python
from tensorflow.keras.utils import to_categorical
```


```python
y_train = to_categorical(y_train, 10)
y_test = to_categorical(y_test, 10)
```


```python
y_train[6666]
```




    array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)



## 4.打造神經網路


```python
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import SGD
```


```python
model = Sequential()
```


```python
#打造一部函數學習機，建三層
```


```python
model.add(Dense(66, input_dim = 784, activation = "relu"))  

model.add(Dense(66, activation = "relu"))

model.add(Dense(10, activation = "softmax"))#把數字變為0-1狀態並加起來為1
```


```python
#組裝我們的神經網路
```


```python
model.compile(loss = 'mse', optimizer = SGD(lr = 0.085), metrics = ['accuracy'])
```


```python
model.summary()
```

    Model: "sequential"
    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    dense (Dense)                (None, 66)                51810     
    _________________________________________________________________
    dense_1 (Dense)              (None, 66)                4422      
    _________________________________________________________________
    dense_2 (Dense)              (None, 10)                670       
    =================================================================
    Total params: 56,902
    Trainable params: 56,902
    Non-trainable params: 0
    _________________________________________________________________



```python
784*66 + 66
```




    51810



## 5.訓練


```python
model.fit(x_train, y_train, batch_size=30, epochs=40)
```

    Train on 60000 samples
    Epoch 1/40
    60000/60000 [==============================] - 13s 223us/sample - loss: 0.0585 - accuracy: 0.5841
    Epoch 2/40
    60000/60000 [==============================] - 10s 162us/sample - loss: 0.0201 - accuracy: 0.8792
    Epoch 3/40
    60000/60000 [==============================] - 8s 139us/sample - loss: 0.0154 - accuracy: 0.9028
    Epoch 4/40
    60000/60000 [==============================] - 9s 144us/sample - loss: 0.0136 - accuracy: 0.9143
    Epoch 5/40
    60000/60000 [==============================] - 9s 145us/sample - loss: 0.0124 - accuracy: 0.9209
    Epoch 6/40
    60000/60000 [==============================] - 9s 147us/sample - loss: 0.0115 - accuracy: 0.9265
    Epoch 7/40
    60000/60000 [==============================] - 9s 150us/sample - loss: 0.0108 - accuracy: 0.9317
    Epoch 8/40
    60000/60000 [==============================] - 9s 147us/sample - loss: 0.0102 - accuracy: 0.9354
    Epoch 9/40
    60000/60000 [==============================] - 8s 130us/sample - loss: 0.0097 - accuracy: 0.9383
    Epoch 10/40
    60000/60000 [==============================] - 10s 160us/sample - loss: 0.0092 - accuracy: 0.9418
    Epoch 11/40
    60000/60000 [==============================] - 8s 141us/sample - loss: 0.0088 - accuracy: 0.9441
    Epoch 12/40
    60000/60000 [==============================] - 8s 136us/sample - loss: 0.0085 - accuracy: 0.9471
    Epoch 13/40
    60000/60000 [==============================] - 8s 137us/sample - loss: 0.0081 - accuracy: 0.9490
    Epoch 14/40
    60000/60000 [==============================] - 8s 133us/sample - loss: 0.0078 - accuracy: 0.9513
    Epoch 15/40
    60000/60000 [==============================] - 8s 133us/sample - loss: 0.0076 - accuracy: 0.9534
    Epoch 16/40
    60000/60000 [==============================] - 8s 138us/sample - loss: 0.0073 - accuracy: 0.9543
    Epoch 17/40
    60000/60000 [==============================] - 8s 132us/sample - loss: 0.0071 - accuracy: 0.9560
    Epoch 18/40
    60000/60000 [==============================] - 8s 133us/sample - loss: 0.0069 - accuracy: 0.9580
    Epoch 19/40
    60000/60000 [==============================] - 8s 135us/sample - loss: 0.0066 - accuracy: 0.9591
    Epoch 20/40
    60000/60000 [==============================] - 8s 135us/sample - loss: 0.0064 - accuracy: 0.9606
    Epoch 21/40
    60000/60000 [==============================] - 8s 133us/sample - loss: 0.0063 - accuracy: 0.9622
    Epoch 22/40
    60000/60000 [==============================] - 8s 135us/sample - loss: 0.0061 - accuracy: 0.9632
    Epoch 23/40
    60000/60000 [==============================] - 8s 134us/sample - loss: 0.0059 - accuracy: 0.9641
    Epoch 24/40
    60000/60000 [==============================] - 8s 133us/sample - loss: 0.0058 - accuracy: 0.9652
    Epoch 25/40
    60000/60000 [==============================] - 8s 134us/sample - loss: 0.0056 - accuracy: 0.9667
    Epoch 26/40
    60000/60000 [==============================] - 8s 134us/sample - loss: 0.0055 - accuracy: 0.9674
    Epoch 27/40
    60000/60000 [==============================] - 8s 137us/sample - loss: 0.0053 - accuracy: 0.9682
    Epoch 28/40
    60000/60000 [==============================] - 8s 136us/sample - loss: 0.0052 - accuracy: 0.9687
    Epoch 29/40
    60000/60000 [==============================] - 8s 141us/sample - loss: 0.0050 - accuracy: 0.9701
    Epoch 30/40
    60000/60000 [==============================] - 8s 136us/sample - loss: 0.0049 - accuracy: 0.9710
    Epoch 31/40
    60000/60000 [==============================] - 8s 134us/sample - loss: 0.0048 - accuracy: 0.9718
    Epoch 32/40
    60000/60000 [==============================] - 8s 134us/sample - loss: 0.0047 - accuracy: 0.9725
    Epoch 33/40
    60000/60000 [==============================] - 8s 135us/sample - loss: 0.0046 - accuracy: 0.9734
    Epoch 34/40
    60000/60000 [==============================] - 9s 151us/sample - loss: 0.0045 - accuracy: 0.9742
    Epoch 35/40
    60000/60000 [==============================] - 10s 170us/sample - loss: 0.0044 - accuracy: 0.9747
    Epoch 36/40
    60000/60000 [==============================] - 10s 169us/sample - loss: 0.0043 - accuracy: 0.9751
    Epoch 37/40
    60000/60000 [==============================] - 10s 159us/sample - loss: 0.0042 - accuracy: 0.9760
    Epoch 38/40
    60000/60000 [==============================] - 10s 163us/sample - loss: 0.0041 - accuracy: 0.9766
    Epoch 39/40
    60000/60000 [==============================] - 9s 152us/sample - loss: 0.0040 - accuracy: 0.9770
    Epoch 40/40
    60000/60000 [==============================] - 10s 166us/sample - loss: 0.0039 - accuracy: 0.9777





    <tensorflow.python.keras.callbacks.History at 0x11295aed0>




```python
#累加會有細微誤差,batch=多少筆後調參數, epochs=訓練幾次。
```

## 6.訓練成果


```python
result = model.predict_classes(x_test)
```


```python
n = 6666

print('神經網路預測是:', result[n])
plt.imshow(x_test[n].reshape(28,28), cmap='Greys')
```

    神經網路預測是: 7





    <matplotlib.image.AxesImage at 0x653812250>




![png](output_35_2.png)



```python
#神經網路預測是: 7
```


```python

```
